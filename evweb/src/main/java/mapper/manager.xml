<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.project.manager">
	<insert id="register" parameterType="manager">
		insert into manager_tb values(
			#{manager_id},#{manager_pass},#{manager_name},#{phone_no},
			#{addr},#{email},#{type},#{company},#{position},#{hire_date,jdbcType=DATE},#{state}
		)	
	</insert>
	<select id="selectall" resultType="manager" parameterType="String">
		select *
				from(select ROWNUM rn, mg.*
				        FROM (select * from manager_tb ) mg)
		<where>
			<if test='_parameter == "7"'>
				rn BETWEEN 1 AND #{endNo} 
			</if>
			<if test='_parameter != "7"'>
				rn BETWEEN #{endNo}-6 AND #{endNo}
			</if>
		</where>
	</select>
	<select id="typeSelect" resultType="manager" parameterType="Map">
		select *
				from(select ROWNUM rn, mg.*
				        FROM (select * from manager_tb where type= #{type}) mg)
		<where>
			<if test='endNo == "7"'>
				rn BETWEEN 1 AND #{endNo} 
			</if>
			<if test='endNo != "7"'>
				rn BETWEEN #{endNo}-6 AND #{endNo}
			</if>
		</where>
	</select>
	<update id="update" parameterType="manager">
		update manager_tb
		set manager_pass = #{manager_pass}, manager_name = #{manager_name}, phone_no = #{phone_no}, 
		addr = #{addr}, email = #{email}, type = #{type}, company = #{company}, position = #{position}, 
		hire_date = #{hire_date,jdbcType=DATE}, state = #{state} 
		where manager_id = #{manager_id}
	</update>
	<select id="read" resultType="manager" parameterType="String">
		select * from manager_tb where manager_id = #{manager_id}
	</select>
	<select id="idcheak" resultType="int" parameterType="String">
		select count(manager_id) from manager_tb where manager_id = #{manager_id}
	</select>
	<select id="list" resultType="manager">
		select * from manager_tb 
	</select>
	<update id="delete" parameterType="String">
		update manager_tb
		set state = '퇴사'
		where manager_id = #{manager_id}
	</update>
	
	
	<select id="findbytype" parameterType="String" resultType="manager">
		select * from manager_tb
		where type = #{type}
	</select>
	
	<select id="findbyname" parameterType="Map" resultType="manager">
		select * from manager_tb 
		<where>
			<if test="type=='all' and manager_name != ''">
				manager_name like '%' || #{manager_name} || '%' 
			</if>
			<if test="type=='사이트 관리자' and manager_name != ''">
				type = '사이트 관리자' and manager_name like '%' || #{manager_name} || '%' 
			</if>
			<if test="type=='충전소 관리자' and manager_name != ''">
				type = '충전소 관리자' and manager_name like '%' || #{manager_name} || '%' 
			</if>
		</where>
	</select>
	
</mapper>